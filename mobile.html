<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="theme-color" content="#0a0a0f">
  <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
  <meta http-equiv="Pragma" content="no-cache">
  <meta http-equiv="Expires" content="0">
  <title>WikiScout</title>
  <link rel="stylesheet" href="css/variables.css?v=1771097114">
  <link rel="stylesheet" href="css/base.css?v=1771097114">
  <link rel="stylesheet" href="css/components.css?v=1771097114">
  <link rel="stylesheet" href="css/mobile.css?v=1771097114">
  <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><rect width='100' height='100' fill='%2300d26a'/><text x='50' y='70' font-size='60' text-anchor='middle' fill='white' font-weight='bold'>W</text></svg>">
  <link rel="apple-touch-icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><rect width='100' height='100' fill='%2300d26a'/><text x='50' y='70' font-size='60' text-anchor='middle' fill='white' font-weight='bold'>W</text></svg>">
</head>
<body>
  <div class="mobile-layout">
    <!-- Update Banner -->
    <div class="update-banner" id="updateBanner" style="display:none;">
      <span class="update-banner-text">A new version of WikiScout is available</span>
      <button class="btn btn-sm btn-primary update-banner-btn" id="updateBannerBtn">Refresh</button>
    </div>

    <!-- Loading Screen -->
    <div class="mobile-loading" id="loadingScreen">
      <div class="mobile-loading-spinner"></div>
      <div class="mobile-loading-text">Loading WikiScout...</div>
    </div>
    
    <!-- Header -->
    <header class="mobile-header">
      <div>
        <div class="mobile-header-title" id="mobileTitle">WikiScout</div>
        <div class="mobile-header-subtitle" id="mobileSubtitle">Team #---</div>
      </div>
      <div style="display: flex; gap: var(--space-sm);">
        <button class="btn btn-icon btn-ghost" id="mobileRefreshBtn">
          <span data-icon="refresh" data-icon-size="20"></span>
        </button>
        <button class="btn btn-icon btn-ghost" id="mobileOtpBtn">
          <span data-icon="key" data-icon-size="20"></span>
        </button>
        <button class="btn btn-icon btn-ghost" id="mobileLogoutBtn">
          <span data-icon="logout" data-icon-size="20"></span>
        </button>
      </div>
    </header>
    
    <!-- Main Content Container -->
    <div class="mobile-content-container">
      <main class="mobile-content">
      
      <!-- Rankings Screen -->
      <div class="screen active" id="screen-rankings">
        <!-- Event Banner -->
        <div class="event-banner" id="rankingsEventBanner">
          <div class="event-banner-icon">
            <span data-icon="mapPin"></span>
          </div>
          <div class="event-banner-info">
            <div class="event-banner-name" id="rankingsEventName">No Event Selected</div>
            <div class="event-banner-code" id="rankingsEventCode">---</div>
          </div>
          <span class="event-banner-chevron" data-icon="chevronDown" data-icon-size="16"></span>
        </div>
        
        <div class="rankings-list" id="mobileRankingsList">
          <div class="empty-state">
            <div class="empty-state-icon" data-icon="rankings" data-icon-size="48"></div>
            <div class="empty-state-title">No Rankings</div>
            <div class="empty-state-text">Rankings will appear when data is available</div>
          </div>
        </div>
      </div>
      
      <!-- Matches Screen -->
      <div class="screen" id="screen-matches">
        <!-- Event Banner -->
        <div class="event-banner" id="matchesEventBanner">
          <div class="event-banner-icon">
            <span data-icon="mapPin"></span>
          </div>
          <div class="event-banner-info">
            <div class="event-banner-name" id="matchesEventName">No Event Selected</div>
            <div class="event-banner-code" id="matchesEventCode">---</div>
          </div>
          <span class="event-banner-chevron" data-icon="chevronDown" data-icon-size="16"></span>
        </div>
        
        <!-- Match Filter Pills -->
        <div class="match-filter-bar">
          <button class="match-filter-pill active" data-match-filter="my-team">My Team</button>
          <button class="match-filter-pill" data-match-filter="all">All</button>
          <button class="match-filter-pill" data-match-filter="upcoming">Upcoming</button>
        </div>
        
        <div class="match-list-container" id="mobileMatchList">
          <div class="empty-state">
            <div class="empty-state-icon" data-icon="matches" data-icon-size="48"></div>
            <div class="empty-state-title">No Matches</div>
            <div class="empty-state-text">Match schedule will appear when data is available</div>
          </div>
        </div>
      </div>
      
      <!-- Data View Screen -->
      <div class="screen" id="screen-data">
        <div class="team-selector">
          <label class="team-selector-label">Select Team</label>
          <div class="custom-team-picker" id="dataTeamPicker">
            <button type="button" class="custom-team-picker-trigger" id="dataTeamPickerBtn">
              <span class="picker-trigger-text">Choose team...</span>
              <span class="picker-trigger-chevron" data-icon="chevronDown" data-icon-size="16"></span>
            </button>
            <input type="hidden" id="mobileTeamSelect" value="">
          </div>
        </div>
        
        <div id="mobileTeamData">
          <div class="empty-state">
            <div class="empty-state-icon" data-icon="data" data-icon-size="48"></div>
            <div class="empty-state-title">Select a Team</div>
            <div class="empty-state-text">Choose a team to view scouting data</div>
          </div>
        </div>
      </div>
      
      <!-- Team Screen (parent accounts only) -->
      <div class="screen" id="screen-team">
        <div class="team-mgmt-header">
          <h2 class="team-mgmt-title">Team Members</h2>
          <span class="team-mgmt-count" id="mobileTeamMemberCount">0</span>
        </div>

        <!-- Add Member Form -->
        <div class="team-mgmt-add-card">
          <form id="mobileAddMemberForm" class="team-mgmt-add-form">
            <input type="text" class="form-input" id="mobileNewMemberName" placeholder="New member name..." autocomplete="off" required>
            <button type="submit" class="btn btn-primary btn-sm" id="mobileAddMemberBtn">
              <span data-icon="plus" data-icon-size="16"></span> Add
            </button>
          </form>
        </div>

        <!-- Member List -->
        <div class="team-mgmt-list" id="mobileTeamMemberList">
          <div class="empty-state">
            <div class="empty-state-icon" data-icon="teams" data-icon-size="48"></div>
            <div class="empty-state-title">No Members</div>
            <div class="empty-state-text">Add scouts to your team to get started</div>
          </div>
        </div>
      </div>

      <!-- Scout Screen -->
      <div class="screen" id="screen-scout">
        <!-- Event Banner -->
        <div class="event-banner" id="scoutEventBanner">
          <div class="event-banner-icon">
            <span data-icon="mapPin"></span>
          </div>
          <div class="event-banner-info">
            <div class="event-banner-name" id="scoutEventName">No Event Selected</div>
            <div class="event-banner-code" id="scoutEventCode">---</div>
          </div>
          <span class="event-banner-chevron" data-icon="chevronDown" data-icon-size="16"></span>
        </div>
        
        <form id="mobileScoutForm" class="scout-form">
          <div class="scout-form-section">
            <div class="scout-form-header">Team Selection</div>
            <div class="scout-form-fields">
              <div class="scout-field">
                <label class="scout-field-label">Team Number</label>
                <div class="custom-team-picker" id="scoutTeamPicker">
                  <button type="button" class="custom-team-picker-trigger" id="scoutTeamPickerBtn">
                    <span class="picker-trigger-text">Select Team</span>
                    <span class="picker-trigger-chevron" data-icon="chevronDown" data-icon-size="16"></span>
                  </button>
                  <input type="hidden" id="mobileScoutTeam" value="" required>
                </div>
              </div>
            </div>
          </div>
          
          <!-- Dynamic form sections will be inserted here -->
          <div id="mobileFormFields"></div>
          
          <!-- Custom Fields Section (loaded dynamically, private) -->
          <div id="mobileCustomFieldsSection" style="display: none;">
            <div class="scout-form-section">
              <div class="scout-form-header" style="display: flex; align-items: center; gap: var(--space-sm);">
                Custom Fields
                <span class="badge badge-secondary" style="font-size: 10px;">Private</span>
              </div>
              <div class="scout-form-fields" id="mobileCustomFieldsContainer">
                <!-- Custom fields rendered here -->
              </div>
            </div>
          </div>
          
          <button type="submit" class="btn btn-primary btn-lg scout-submit-float" id="mobileScoutSubmitBtn">
            <span class="scout-submit-text">Submit</span>
            <span class="scout-submit-loading" style="display:none;">
              <span class="mobile-loading-spinner" style="width:18px;height:18px;border-width:2px;"></span>
              Saving...
            </span>
          </button>
        </form>
      </div>
      </main>
    </div>
    
    <!-- Bottom Navigation Container -->
    <div class="mobile-nav-container">
      <nav class="mobile-nav">
      <a href="#" class="mobile-nav-item" data-screen="team" id="mobileNavTeam" style="display: none;">
        <span class="mobile-nav-icon" data-icon="teams"></span>
        <span class="mobile-nav-label">Team</span>
      </a>
      <a href="#" class="mobile-nav-item active" data-screen="rankings">
        <span class="mobile-nav-icon" data-icon="rankings"></span>
        <span class="mobile-nav-label">Rankings</span>
      </a>
      <a href="#" class="mobile-nav-item" data-screen="matches">
        <span class="mobile-nav-icon" data-icon="matches"></span>
        <span class="mobile-nav-label">Matches</span>
      </a>
      <a href="#" class="mobile-nav-item" data-screen="data">
        <span class="mobile-nav-icon" data-icon="data"></span>
        <span class="mobile-nav-label">Data</span>
      </a>
      <a href="#" class="mobile-nav-item" data-screen="scout">
        <span class="mobile-nav-icon" data-icon="scout"></span>
        <span class="mobile-nav-label">Scout</span>
      </a>
      </nav>
    </div>
    
    <!-- FAB for quick scout -->
    <button class="fab" id="fabScout">
      <span data-icon="scout" data-icon-size="24"></span>
    </button>
  </div>
  
  <!-- Team Stats Popup (Match History) -->
  <div class="stats-popup" id="statsPopup">
    <div class="stats-popup-content">
      <div class="stats-popup-header">
        <div class="stats-popup-title" id="statsTeamTitle">Team 0000</div>
        <div class="stats-popup-subtitle" id="statsTeamName">Team Name</div>
      </div>
      
      <div class="stats-wlt">
        <div class="stats-wlt-box wins" id="statsWins">0</div>
        <div class="stats-wlt-box ties" id="statsTies">0</div>
        <div class="stats-wlt-box losses" id="statsLosses">0</div>
      </div>
      
      <div class="stats-played" id="statsPlayed">Matches Played: 0</div>
      
      <div class="stats-advanced" id="statsAdvanced" style="display: none;">
        <div class="stats-advanced-row">
          <div class="stats-advanced-item">
            <div class="stats-advanced-label">OPR</div>
            <div class="stats-advanced-value" id="statsOPR">—</div>
            <div class="stats-advanced-rank" id="statsOPRRank"></div>
          </div>
          <div class="stats-advanced-item">
            <div class="stats-advanced-label">Avg Score</div>
            <div class="stats-advanced-value" id="statsAvgScore">—</div>
          </div>
          <div class="stats-advanced-item">
            <div class="stats-advanced-label">Schedule</div>
            <div class="stats-advanced-value" id="statsSoS">—</div>
            <div class="stats-advanced-rank" id="statsSoSLabel"></div>
          </div>
        </div>
      </div>
      
      <div class="stats-match-list" id="statsMatchList">
        <!-- Match results will be inserted here -->
      </div>
      
      <div class="stats-actions">
        <button class="btn btn-primary" id="statsViewData">View Scouting Data</button>
        <button class="btn btn-ghost" id="statsClose">Close</button>
      </div>
    </div>
  </div>
  
  <!-- Mobile Event Picker Modal -->
  <div class="mobile-ep-overlay" id="mobileEventPickerModal" style="display: none;">
    <div class="mobile-ep-dialog">
      <div class="mobile-ep-header">
        <h3>Select Event</h3>
        <div style="display: flex; align-items: center; gap: 12px;">
          <select class="form-input form-select" id="mobileEpSeasonSelect" style="display: none; width: 100px; padding: 4px 8px; font-size: 12px;">
            <!-- Seasons populated by JS -->
          </select>
          <button class="btn btn-ghost btn-icon btn-sm" id="mobileEpClose">
            <span data-icon="x" data-icon-size="18"></span>
          </button>
        </div>
      </div>
      <div class="mobile-ep-search">
        <div class="search-input">
          <span class="search-input-icon" data-icon="search" data-icon-size="16"></span>
          <input type="text" placeholder="Search events..." id="mobileEpSearchInput" autocomplete="off">
        </div>
      </div>
      <div class="mobile-ep-tabs">
        <button class="mobile-ep-tab active" data-ep-filter="today">Today</button>
        <button class="mobile-ep-tab" data-ep-filter="my-team">My Team</button>
        <button class="mobile-ep-tab" data-ep-filter="all">All</button>
      </div>
      <div class="mobile-ep-list" id="mobileEpEventList">
        <div class="mobile-ep-loading">Loading events...</div>
      </div>
    </div>
  </div>

  <!-- Team Picker Bottom Sheet -->
  <div class="team-picker-overlay" id="teamPickerOverlay"></div>
  <div class="team-picker-sheet" id="teamPickerSheet">
    <div class="team-picker-drag-handle"><div class="drag-handle-bar"></div></div>
    <div class="team-picker-header">
      <h3 class="team-picker-title">Select Team</h3>
      <button type="button" class="btn btn-icon btn-ghost btn-sm" id="teamPickerClose">
        <span data-icon="x" data-icon-size="20"></span>
      </button>
    </div>
    <div class="team-picker-search">
      <input type="text" class="form-input" id="teamPickerSearchInput" placeholder="Search by number or name..." autocomplete="off">
    </div>
    <div class="team-picker-legend">
      <span class="team-picker-legend-item"><span class="tp-badge tp-badge-scouted"></span> Scouted</span>
      <span class="team-picker-legend-item"><span class="tp-badge tp-badge-assigned"></span> Assigned</span>
    </div>
    <div class="team-picker-list" id="teamPickerList">
      <!-- Filled by JS -->
    </div>
  </div>

  <!-- Match Scouting Bottom Sheet -->
  <div class="match-scout-sheet" id="matchScoutSheet">
    <div class="match-scout-sheet-drag-handle" id="matchScoutDragHandle">
      <div class="drag-handle-bar"></div>
    </div>
    <div class="match-scout-sheet-header">
      <div>
        <h3 class="match-scout-sheet-title" id="matchScoutTitle">Qualifier 1</h3>
        <span class="match-scout-sheet-subtitle" id="matchScoutSubtitle">Tap a team to add notes</span>
      </div>
      <button class="btn btn-icon btn-ghost btn-sm" id="closeMatchScoutSheet">
        <span data-icon="x" data-icon-size="20"></span>
      </button>
    </div>
    
    <!-- Alliance Summary -->
    <div class="match-scout-alliances" id="matchScoutAlliances">
      <!-- Filled by JS -->
    </div>
    
    <!-- Team Note Cards -->
    <div class="match-scout-teams" id="matchScoutTeams">
      <!-- Filled by JS -->
    </div>
  </div>
  <div class="match-scout-overlay" id="matchScoutOverlay"></div>

  <!-- Member Detail Bottom Sheet -->
  <div class="bottom-sheet" id="memberDetailSheet">
    <div class="bottom-sheet-header">
      <h3 class="bottom-sheet-title" id="memberDetailSheetName">Member</h3>
      <button class="btn btn-icon btn-ghost btn-sm" id="closeMemberDetailSheet">
        <span data-icon="x" data-icon-size="20"></span>
      </button>
    </div>
    <div class="bottom-sheet-body">
      <!-- Status & Info -->
      <div class="tm-detail-info">
        <div class="tm-detail-row">
          <span class="tm-detail-label">Status</span>
          <span class="tm-detail-value" id="memberDetailStatus">Active</span>
        </div>
        <div class="tm-detail-row">
          <span class="tm-detail-label">Added</span>
          <span class="tm-detail-value" id="memberDetailCreated">—</span>
        </div>
        <div class="tm-detail-row">
          <span class="tm-detail-label">Last Login</span>
          <span class="tm-detail-value" id="memberDetailLastLogin">Never</span>
        </div>
      </div>

      <!-- Assigned Teams Section -->
      <div class="tm-teams-section">
        <div class="tm-detail-row" style="border-bottom: none;">
          <span class="tm-detail-label">Assigned Teams</span>
          <span class="tm-detail-value" id="memberDetailTeams">All teams</span>
        </div>
        <button class="btn btn-secondary btn-sm" id="memberEditTeamsBtn" style="width: 100%;">
          <span data-icon="edit" data-icon-size="14"></span> Edit Assigned Teams
        </button>
      </div>

      <!-- Credentials Section -->
      <div class="tm-creds-section">
        <div class="tm-creds-title">Login Credentials</div>
        <div class="tm-otp-display" id="memberDetailOtp">
          <div class="otp-digits" style="margin-bottom: var(--space-sm);">
            <div class="otp-digit">-</div>
            <div class="otp-digit">-</div>
            <div class="otp-digit">-</div>
            <div class="otp-dash">-</div>
            <div class="otp-digit">-</div>
            <div class="otp-digit">-</div>
            <div class="otp-digit">-</div>
          </div>
        </div>
        <div class="tm-creds-expire" id="memberDetailOtpExpiry"></div>
        <div class="tm-creds-buttons">
          <button class="btn btn-primary btn-sm" id="memberGenCredsBtn" style="flex: 1;">
            <span data-icon="key" data-icon-size="14"></span> Generate
          </button>
          <button class="btn btn-secondary btn-sm" id="memberShowQrBtn" style="flex: 1;" disabled>
            <span data-icon="qrcode" data-icon-size="14"></span> QR Code
          </button>
        </div>
      </div>

      <!-- Actions -->
      <div class="tm-detail-actions">
        <button class="btn btn-ghost btn-sm" id="memberToggleBtn" style="flex: 1;">
          <span data-icon="pause" data-icon-size="14"></span> Deactivate
        </button>
        <button class="btn btn-danger btn-sm" id="memberDeleteBtn" style="flex: 1;">
          <span data-icon="x" data-icon-size="14"></span> Remove
        </button>
      </div>
    </div>
  </div>
  <div class="modal-overlay" id="memberDetailOverlay"></div>

  <!-- Assign Teams Bottom Sheet -->
  <div class="bottom-sheet" id="assignTeamsSheet">
    <div class="bottom-sheet-header">
      <h3 class="bottom-sheet-title">Assign Teams</h3>
      <button class="btn btn-icon btn-ghost btn-sm" id="closeAssignTeamsSheet">
        <span data-icon="x" data-icon-size="20"></span>
      </button>
    </div>
    <div class="bottom-sheet-body">
      <div class="at-search-row">
        <input type="text" class="form-input" id="assignTeamsSearch" placeholder="Search teams..." autocomplete="off">
      </div>
      <label class="at-select-all">
        <input type="checkbox" id="assignTeamsAllToggle"> <span>All Teams (no filter)</span>
      </label>
      <div class="at-team-list" id="assignTeamsList">
        <!-- Checkboxes populated by JS -->
      </div>
      <button class="btn btn-primary" id="assignTeamsSaveBtn" style="width: 100%; margin-top: var(--space-md);">
        Save
      </button>
    </div>
  </div>
  <div class="modal-overlay" id="assignTeamsOverlay"></div>

  <!-- QR Code Enlarge Overlay -->
  <div class="tm-qr-overlay" id="qrEnlargeOverlay" style="display: none;">
    <div class="tm-qr-overlay-content" id="qrEnlargeContent">
      <!-- Large QR inserted by JS -->
    </div>
  </div>

  <!-- OTP Bottom Sheet -->
  <div class="bottom-sheet" id="otpSheet">
    <div class="bottom-sheet-header">
      <h3 class="bottom-sheet-title">Desktop Login</h3>
      <button class="btn btn-icon btn-ghost btn-sm" id="closeOtpSheet">
        <span data-icon="x" data-icon-size="20"></span>
      </button>
    </div>
    <div class="bottom-sheet-body">
      <p style="color: var(--text-secondary); margin-bottom: var(--space-xl); text-align: center;">
        Use this code to log in to the desktop version of WikiScout
      </p>
      
      <div class="otp-label" style="text-align: center; margin-bottom: var(--space-md); font-weight: 600;">Your OTP Code</div>
      <div class="otp-digits" id="mobileOtpDigits" style="margin-bottom: var(--space-xl);">
        <div class="otp-digit">-</div>
        <div class="otp-digit">-</div>
        <div class="otp-digit">-</div>
        <div class="otp-dash">-</div>
        <div class="otp-digit">-</div>
        <div class="otp-digit">-</div>
        <div class="otp-digit">-</div>
      </div>
      
      <div style="display: flex; gap: var(--space-md);">
        <button class="btn btn-danger" id="mobileDeleteOtp" style="flex: 1;">Delete</button>
        <button class="btn btn-primary" id="mobileRegenOtp" style="flex: 1;">Regenerate</button>
      </div>
    </div>
  </div>
  
  <!-- Modal Overlay for OTP Sheet -->
  <div class="modal-overlay" id="otpSheetOverlay"></div>

  <!-- Scripts -->
  <script>var WIKISCOUT_BUILD = '1771097114';</script>
  <script src="js/view-detector.js?v=1771097114"></script>
  <script src="js/icons.js?v=1771097114"></script>
  <script src="js/utils.js?v=1771097114"></script>
  <script src="js/api.js?v=1771097114"></script>
  <script src="js/version-check.js?v=1771097114"></script>
  <script src="js/mobile-app.js?v=1771097114"></script>
</body>
</html>
